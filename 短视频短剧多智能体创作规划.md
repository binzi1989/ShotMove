# 短视频 + 短剧 多智能体创作系统 · 规划文档

> 目标：根据用户不同输入（商品链接 / 剧本等）自动判断需求类型，通过多智能体协作 + 接入现成 Skill/API，生成对应创作内容，避免从零造轮子。

---

## 一、项目愿景与目标

| 维度 | 说明 |
|------|------|
| **核心能力** | 短视频创作 + 短剧创作，统一入口，按需分流 |
| **输入形态** | 用户可能扔过来：**商品链接**、**剧本/文案**、或**纯自然语言需求** |
| **输出形态** | 商品种草短视频、剧情短剧视频、口播/分镜脚本等 |
| **设计原则** | 自动识别输入类型 → 路由到对应管线 → **尽量接入现成 Skill/API**，不重复造轮子 |

---

## 二、用户输入类型与自动识别

### 2.1 输入类型定义

| 类型 | 典型输入 | 识别依据 | 预期产出 |
|------|----------|----------|----------|
| **商品链接** | 淘宝/京东/拼多多等 URL | URL 正则 + 域名/路径特征 | 商品种草短视频（脚本+分镜+可对接视频生成） |
| **剧本/文案** | 多段对白、场景描述、分镜稿 | 含场景/角色/对白结构、篇幅较长 | 短剧分镜脚本 → 可对接短剧视频生成 API |
| **自然语言需求** | 「帮我做一个卖XX的短视频」「写一个霸总短剧」 | 意图分类（商品推广 vs 剧情创作） | 先补全/确认需求，再走对应管线 |

### 2.2 自动判断策略（建议）

- **第一步：链接检测**  
  若输入包含 `http(s)://` 且域名匹配电商（如 `item.taobao.com`、`item.jd.com`、`mobile.yangkeduo.com` 等）→ 归为 **商品链接**。
- **第二步：剧本特征**  
  若为纯文本且包含：多角色对白、场景切换描述、镜头/分镜关键词、较长段落结构 → 归为 **剧本/短剧**。
- **第三步：意图分类**  
  其余情况用 **轻量意图分类**（可接入一个分类 API 或本地小模型）区分为：商品推广 / 短剧创作 / 其他，再路由。

无需自研复杂 NLP，**正则 + 规则 + 可选单一分类 API** 即可完成路由。

---

## 三、多智能体架构设计

### 3.1 总体架构（路由 + 专项 Agent + Skill 接入）

```
                    ┌─────────────────────────────────────────┐
                    │           用户输入（链接/剧本/自然语言）   │
                    └─────────────────┬───────────────────────┘
                                      │
                                      ▼
                    ┌─────────────────────────────────────────┐
                    │  路由 / 分类 Agent（输入类型识别）         │
                    │  - 链接检测 → 商品链接                    │
                    │  - 剧本特征 → 短剧/剧本                   │
                    │  - 其余 → 意图分类                        │
                    └─────────────────┬───────────────────────┘
                                      │
              ┌───────────────────────┼───────────────────────┐
              │                       │                         │
              ▼                       ▼                         ▼
    ┌─────────────────┐   ┌─────────────────┐   ┌─────────────────┐
    │ 商品短视频 Agent  │   │ 短剧创作 Agent   │   │ 需求澄清 Agent   │
    │ - 解析商品信息   │   │ - 剧本/分镜理解  │   │ - 与用户确认     │
    │ - 写种草脚本     │   │ - 分镜/镜头规划  │   │ - 再路由         │
    │ - 对接商品API   │   │ - 对接短剧API    │   │                 │
    └────────┬────────┘   └────────┬────────┘   └─────────────────┘
             │                     │
             ▼                     ▼
    ┌─────────────────┐   ┌─────────────────┐
    │ 接入 Skill/API   │   │ 接入 Skill/API   │
    │ - 商品详情 API   │   │ - 文生视频 API   │
    │ - 文生视频/口播  │   │ - 参考生视频     │
    │ - 数字人/口型    │   │ - 分镜/配音      │
    └─────────────────┘   └─────────────────┘
```

### 3.2 各 Agent 职责（简要）

| Agent | 职责 | 可接入能力（不造轮子） |
|-------|------|------------------------|
| **路由 Agent** | 解析输入，判断类型，调用下游 Agent | 正则/规则 + 可选分类 API |
| **商品短视频 Agent** | 从链接取商品信息 → 生成种草脚本/分镜 → 可调用视频生成 | 电商商品 API、文生视频/图生视频 API、数字人/口型 API |
| **短剧创作 Agent** | 理解剧本/分镜 → 输出标准分镜或可直接喂给短剧 API 的结构化数据 | 文生视频、参考生视频（角色一致）、多镜头/配音 API |
| **需求澄清 Agent** | 意图不明时与用户对话，补全信息后再路由 | 对话/提示词即可，无需额外 API |

---

## 四、可接入的 Skill / 服务（直接复用）

### 4.1 商品侧

| 能力 | 说明 | 接入方式 |
|------|------|----------|
| **商品详情 API** | 从淘宝/京东/拼多多链接取标题、价格、主图、卖点等 | 阿里云电商 API、京东开放平台、订单侠等第三方聚合 |
| **链接解析** | URL → 平台 + 商品 ID，再调详情 API | 各平台文档均有链接解析或 ID 提取说明 |

不推荐自己爬页面，用 **官方/合规开放 API** 或成熟第三方即可。

### 4.2 视频生成侧（短视频 + 短剧）

| 能力 | 说明 | 接入方式 |
|------|------|----------|
| **文生视频** | 文案/分镜描述 → 短视频片段 | 阿里通义万相 文生视频 API、可灵、即梦、Runway 等 |
| **参考生视频 / 图生视频** | 保持角色/风格一致，适合短剧多镜头 | 通义万相 参考生视频 API、可灵、即梦等 |
| **口型/数字人** | 文案 → 口播视频，适合种草 | 有言 AI、白日梦 AI、各云厂商数字人 API |
| **短剧一站式** | 剧本/分镜 → 成片（多镜头+配音） | 阿里云短剧漫剧场景、各厂商短剧解决方案 |

优先用 **云厂商已封装好的短剧/视频 API**，减少自研编排与调参。

### 4.3 与 Cursor / Agent Skills 的结合方式（可选）

本项目的三个 Skill 与 [Anthropic 的 Skills 仓库](https://github.com/anthropics/skills) 及 [Agent Skills 标准](https://agentskills.io) 格式对齐，详见 `.cursor/skills/README.md`。

在 Cursor 内做「创作管线」时，可以把每个管线做成 **一个 Skill**，便于复用和触发：

| Skill 名称 | 触发场景 | 内容 |
|------------|----------|------|
| `product-video-skill` | 用户提供商品链接或明确说「做商品短视频」 | 调用商品 API 的步骤、脚本模板、对接哪家视频 API |
| `script-drama-skill` | 用户提供剧本或「写/拍短剧」 | 分镜结构约定、对接哪家短剧/文生视频 API、输出格式 |
| `input-router-skill` | 任意创作类请求 | 如何根据链接/文本判断类型并选择上述两个 Skill |

这样：**路由逻辑 + 商品管线 + 短剧管线** 都可用「接入现有 API + Cursor Skill」完成，无需从零写复杂业务代码。

---

## 五、工作流与编排（概要）

1. **接收输入** → 统一入口（例如 Cursor 对话、或自建 API 一层）。
2. **路由 Agent** 执行：
   - 是否包含电商链接 → 是则走 **商品短视频 Agent**；
   - 是否像剧本/分镜 → 是则走 **短剧创作 Agent**；
   - 否则走 **需求澄清 Agent**，必要时再路由。
3. **商品短视频 Agent**：  
   解析链接 → 调商品 API 拿信息 → 生成种草脚本/分镜 → 可选：调文生视频/数字人 API 出片。
4. **短剧创作 Agent**：  
   解析剧本/分镜 → 生成或规整为 API 所需格式 → 调短剧/文生视频/参考生视频 API 出片。
5. **输出**：  
   至少返回「脚本 + 分镜」；若接入了视频 API，可返回视频或任务 ID。

编排层只需做 **输入 → 路由 → 调用对应 Agent → 调用对应 Skill/API**，逻辑清晰即可。

---

## 六、技术选型建议（偏「接入」）

| 层级 | 建议 | 说明 |
|------|------|------|
| **路由/分类** | 规则 + 可选单一意图分类 API | 不引入重模型，保证可控、可解释 |
| **商品信息** | 阿里云/京东/第三方电商 API | 合规、稳定，避免爬虫 |
| **短视频生成** | 通义万相、可灵、即梦等 API | 按账号与成本选一家或多家组合 |
| **短剧生成** | 阿里云短剧场景、各厂短剧 API | 优先用现成「剧本→成片」能力 |
| **Agent 实现** | Cursor + Skill 或自建轻量编排服务 | 先以 Cursor Skill 快速验证管线 |

---

## 七、实施阶段与里程碑

| 阶段 | 目标 | 产出 |
|------|------|------|
| **Phase 1：规划与接入清单** | 确定路由规则 + 选定要接入的 API/平台 | 本文档 + 接口清单表（含文档链接、账号要求） |
| **Phase 2：路由 + 单管线** | 先打通「商品链接 → 商品信息 → 种草脚本」或「剧本 → 分镜」其中一条 | 可运行的路由 + 一个完整 Agent（含 Skill 或脚本） |
| **Phase 3：双管线 + 视频** | 两条管线都通，并接入至少一家视频/短剧 API | 从链接或剧本到「脚本+分镜+可选视频」 |
| **Phase 4：体验与扩展** | 需求澄清、多平台链接、多视频 API 切换 | 稳定可用、可扩展的创作入口 |

---

## 八、下一步可执行动作

1. **定接口清单**：从本文「可接入 Skill/服务」里勾选具体厂商与 API（如阿里云商品 + 通义万相短剧），列成表格，便于开发对接。
2. **写路由规则**：把「链接正则 + 剧本特征关键词 + 意图分类规则」写成文档或配置，供路由 Agent 使用。
3. **建 Cursor Skill**：按 `input-router-skill`、`product-video-skill`、`script-drama-skill` 三个先各建一个 SKILL.md，内容为「何时触发 + 调用哪些 API + 输入输出格式」。
4. **做最小闭环**：选一种输入（例如仅京东链接）+ 一个视频 API，实现从链接到脚本或到 5 秒视频的 E2E 演示。

若你希望，我可以下一步直接帮你：  
- 写出一份「可接入 API 清单表（含示例链接）」；或  
- 写出上述三个 Cursor Skill 的 SKILL.md 初稿（仅框架与步骤，具体 API 由你填）。

---

*文档版本：v0.1 | 以「接入现成 Skill/API」为主，多智能体负责路由与编排。*
